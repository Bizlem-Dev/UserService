YAHOO.util.CrossFrame=function(){function parseQueryString(e){var t,n,r;t={};n=e.split("&");for(i=0;i<n.length;i++){r=n[i].split("=");if(r.length===2&&r[0].length>0){t[r[0]]=unescape(r[1])}}return t}var r1=/^(((top|parent|frames\[((['"][a-zA-Z\d-_]*['"])|\d+)\]))(\.|$))+/;var r2=/top|parent|frames\[(?:(?:['"][a-zA-Z]*['"])|\d+)\]/;if(YAHOO.env.ua.opera){document.addEventListener("message",function(e){var t=parseQueryString(e.data);if(YAHOO.lang.hasOwnProperty(t,"target")&&YAHOO.lang.hasOwnProperty(t,"message")&&YAHOO.lang.hasOwnProperty(t,"domain")&&YAHOO.lang.hasOwnProperty(t,"uri")){if(t.target.length>0){YAHOO.util.CrossFrame.send(null,t.target,t.message,t.domain,t.uri)}else{YAHOO.util.CrossFrame.onMessageEvent.fire(t.message,t.domain,t.uri)}}},false)}return{onMessageEvent:new YAHOO.util.CustomEvent("onMessage"),send:function(proxy,target,message){var m,t,d,u,s,el;if(!r1.test(target)){throw new Error("Invalid target: "+target)}if(YAHOO.env.ua.opera){m=r2.exec(target);t=eval(m[0]).document;target=target.substr(m[0].length+1);d=arguments.length>3?arguments[3]:document.domain;u=arguments.length>4?arguments[4]:location.href;s="target="+escape(target)+"&message="+escape(message)+"&domain="+escape(d)+"&uri="+escape(u);t.postMessage(s)}else{el=document.createElement("iframe");el.style.position="absolute";el.style.visibility="hidden";el.style.top=el.style.left="0";el.style.width=el.style.height="0";document.body.appendChild(el);YAHOO.util.Event.addListener(el,"load",function(){YAHOO.util.Event.removeListener(this,"load",arguments.callee);setTimeout(function(){document.body.removeChild(el)},1e3)});s="target="+escape(target)+"&message="+escape(message)+"&domain="+escape(document.domain)+"&uri="+escape(location.href);el.src=proxy+"#"+s;document.body.appendChild(el)}}}}()