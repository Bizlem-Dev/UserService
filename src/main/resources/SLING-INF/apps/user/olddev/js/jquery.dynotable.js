(function(e){e.fn.extend({dynoTable:function(t){var n={removeClass:".row-remover",cloneClass:".row-cloner",addRowTemplateId:"#add-template",addRowButtonId:"#add-row",lastRowRemovable:true,orderable:true,dragHandleClass:".drag-handle",insertFadeSpeed:"slow",removeFadeSpeed:"fast",hideTableOnEmpty:true,onRowRemove:function(){},onRowClone:function(){},onRowAdd:function(){},onTableEmpty:function(){},onRowReorder:function(){}};t=e.extend(n,t);var r=function(n){var r=e(n).closest("tr").clone();var s=e(n).closest("tbody");i(r,s);t.onRowClone()};var i=function(n,r){var i=e(r).children("tr").length;if(t.hideTableOnEmpty&&i==0){e(r).parents("table").first().show()}e(n).find("*").andSelf().filter("[id]").each(function(){this.id+="__c"});e(r).append(n);f(n);e(r).children("tr:last").hide().fadeIn(t.insertFadeSpeed)};var s=function(n){var r=e(n).parents("tbody:first");var i=e(r).children("tr").length;if(i>1||t.lastRowRemovable===true){var s=e(n).parents("tr:first");e(s).fadeOut(t.removeFadeSpeed,function(){e(s).remove();t.onRowRemove();if(i==1){if(t.hideTableOnEmpty){e(r).parents("table").first().hide()}t.onTableEmpty()}})}};var o=function(t,n){e(t).click(n)};var u=function(t){o(t,function(){var t=e(this);r(t);return false})};var a=function(t){o(t,function(){var t=e(this);s(t);return false})};var f=function(n){n.find(t.removeClass).each(function(){a(e(this))});n.find(t.cloneClass).each(function(){u(e(this))})};return this.each(function(){if(this.nodeName.toLowerCase()=="table"){var n=e(this);var r=e(n).children("tbody").first();if(t.orderable&&jQuery().sortable){e(r).sortable({handle:t.dragHandleClass,helper:function(t,n){n.children().each(function(){e(this).width(e(this).width())});return n},items:"tr",update:function(e,n){t.onRowReorder()}})}e(n).find(t.addRowTemplateId).each(function(){e(this).removeAttr("id");var n=e(this);n.remove();o(e(t.addRowButtonId),function(){var e=n.clone();i(e,r);t.onRowAdd();return false})});f(n);var s=e(r).children("tr").length;if(t.hideTableOnEmpty&&s==0){e(n).hide()}}})}})})(jQuery)