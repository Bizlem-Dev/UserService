(function(e){function t(e,t,n){function r(o,u){i();e.data("hasActiveHover")||(o?(u&&e.data("forcedOpen",!0),n.showTip(e)):(a.popOpenImminent=!0,s=setTimeout(function(){s=null;var i=Math.abs(a.previousX-a.currentX),o=Math.abs(a.previousY-a.currentY);i+o<t.intentSensitivity?n.showTip(e):(a.previousX=a.currentX,a.previousY=a.currentY,r())},t.intentPollInterval)))}function i(){s=clearTimeout(s)}var s=null;return{show:r,hide:function(r){i();e.data("hasActiveHover")&&(a.popOpenImminent=!1,e.data("forcedOpen",!1),r?n.hideTip(e):s=setTimeout(function(){s=null;n.hideTip(e)},t.closeDelay))},cancel:i}}function n(t){function n(i){if(i.data("hasActiveHover"))if(a.isPopOpen)a.isClosing||r(a.activeHover),v.delay(100).queue(function(e){n(i);e()});else{i.trigger("powerTipPreRender");var u=i.data("powertip"),l=i.data("powertiptarget"),g=i.data("powertipjq"),y=l?e("#"+l):[];if(u)v.html(u);else if(g&&0<g.length)v.empty(),g.clone(!0,!0).appendTo(v);else if(y&&0<y.length)v.html(e("#"+l).html());else return;i.trigger("powerTipRender");s.on("closePowerTip",function(){i.data("displayController").hide(!0)});a.activeHover=i;a.isPopOpen=!0;v.data("followMouse",t.followMouse);v.data("mouseOnToPopup",t.mouseOnToPopup);if(t.followMouse)h();else{var w=v.outerWidth(),E=v.outerHeight(),S,T,N;t.smartPlacement?(u=e.fn.powerTip.smartPlacementLists[t.placement],e.each(u,function(e,t){S=p(i,t,w,E);T=t;var n=S,r=o.scrollLeft(),s=o.scrollTop(),u=o.width(),a=o.height(),f=[];n.y<s&&f.push("top");n.y+E>s+a&&f.push("bottom");n.x<r&&f.push("left");n.x+w>r+u&&f.push("right");N=f;if(0===N.length)return!1})):(S=p(i,t.placement,w,E),T=t.placement);v.addClass(T);d(S.x,S.y);a.isFixedPopOpen=!0}v.fadeIn(t.fadeInTime,function(){a.desyncTimeout||(a.desyncTimeout=setInterval(f,500));i.trigger("powerTipOpen")})}}function r(e){a.isClosing=!0;e.data("hasActiveHover",!1);e.data("forcedOpen",!1);a.activeHover=null;a.isPopOpen=!1;a.desyncTimeout=clearInterval(a.desyncTimeout);s.off("closePowerTip");v.fadeOut(t.fadeOutTime,function(){a.isClosing=!1;a.isFixedPopOpen=!1;v.removeClass();d(a.currentX+t.offset,a.currentY+t.offset);e.trigger("powerTipClose")})}function f(){if(a.isPopOpen&&!a.isClosing){var e=!1;!1===a.activeHover.data("hasActiveHover")?e=!0:!i(a.activeHover)&&!a.activeHover.is(":focus")&&!a.activeHover.data("forcedOpen")&&(v.data("mouseOnToPopup")?i(v)||(e=!0):e=!0);e&&r(a.activeHover)}}function h(){if(a.isPopOpen&&!a.isFixedPopOpen||a.popOpenImminent&&!a.isFixedPopOpen&&v.data("hasMouseMove")){var e=o.scrollTop(),n=o.width(),r=o.height(),i=v.outerWidth(),s=v.outerHeight(),u=0,f=0,u=i+a.currentX+t.offset<n?a.currentX+t.offset:n-i,f=s+a.currentY+t.offset<e+r?a.currentY+t.offset:e+r-s;d(u,f)}}function p(e,n,r,i){var s=e.offset(),o=e.outerWidth(),e=e.outerHeight(),u=0,a=0;switch(n){case"n":u=s.left+o/2-r/2;a=s.top-i-t.offset;break;case"e":u=s.left+o+t.offset;a=s.top+e/2-i/2;break;case"s":u=s.left+o/2-r/2;a=s.top+e+t.offset;break;case"w":u=s.left-r-t.offset;a=s.top+e/2-i/2;break;case"nw":u=s.left-r+20;a=s.top-i-t.offset;break;case"ne":u=s.left+o-20;a=s.top-i-t.offset;break;case"sw":u=s.left-r+20;a=s.top+e+t.offset;break;case"se":u=s.left+o-20,a=s.top+e+t.offset}return{x:Math.round(u),y:Math.round(a)}}function d(e,t){v.css("left",e+"px");v.css("top",t+"px")}var v=e("#"+t.popupId);0===v.length&&(v=e("<div></div>",{id:t.popupId}),0===u.length&&(u=e("body")),u.append(v));if(t.followMouse){if(!v.data("hasMouseMove"))s.on({mousemove:h,scroll:h});v.data("hasMouseMove",!0)}if(t.followMouse||t.mouseOnToPopup)v.on({mouseenter:function(){(v.data("followMouse")||v.data("mouseOnToPopup"))&&a.activeHover&&a.activeHover.data("displayController").cancel()},mouseleave:function(){v.data("mouseOnToPopup")&&a.activeHover&&a.activeHover.data("displayController").hide()}});return{showTip:function(e){e.data("hasActiveHover",true);v.queue(function(t){n(e);t()})},hideTip:r}}function r(e){a.currentX=e.pageX;a.currentY=e.pageY}function i(e){var t=e.offset();return a.currentX>=t.left&&a.currentX<=t.left+e.outerWidth()&&a.currentY>=t.top&&a.currentY<=t.top+e.outerHeight()}var s=e(document),o=e(window),u=e("body"),a={isPopOpen:!1,isFixedPopOpen:!1,isClosing:!1,popOpenImminent:!1,activeHover:null,currentX:0,currentY:0,previousX:0,previousY:0,desyncTimeout:null,mouseTrackingActive:!1};e.fn.powerTip=function(o){if(!this.length)return this;var u=e.extend({},e.fn.powerTip.defaults,o),f=new n(u),l=0,h=0;a.mouseTrackingActive||(a.mouseTrackingActive=!0,e(function(){l=s.scrollLeft();h=s.scrollTop()}),s.on({mousemove:r,scroll:function(){var e=s.scrollLeft(),t=s.scrollTop();e!==l&&(a.currentX+=e-l,l=e);t!==h&&(a.currentY+=t-h,h=t)}}));this.each(function(){var n=e(this),r=n.data("powertip"),i=n.data("powertipjq"),s=n.data("powertiptarget"),o=n.attr("title");if(!r&&!s&&!i&&o){n.data("powertip",o);n.removeAttr("title")}n.data("displayController",new t(n,u,f))});return this.on({mouseenter:function(t){r(t);a.previousX=t.pageX;a.previousY=t.pageY;e(this).data("displayController").show()},mouseleave:function(){e(this).data("displayController").hide()},focus:function(){var t=e(this);i(t)||t.data("displayController").show(true)},blur:function(){e(this).data("displayController").hide(true)}})};e.fn.powerTip.defaults={fadeInTime:200,fadeOutTime:100,followMouse:!1,popupId:"powerTip",intentSensitivity:7,intentPollInterval:100,closeDelay:100,placement:"n",smartPlacement:!1,offset:10,mouseOnToPopup:!1};e.fn.powerTip.smartPlacementLists={n:["n","ne","nw","s"],e:"e ne se w nw sw n s e".split(" "),s:["s","se","sw","n"],w:"w nw sw e ne se n s w".split(" "),nw:"nw w sw n s se nw".split(" "),ne:"ne e se n s sw ne".split(" "),sw:"sw w nw s n ne sw".split(" "),se:"se e ne s n nw se".split(" ")};e.powerTip={showTip:function(t){e.powerTip.closeTip();t=t.first();i(t)||t.data("displayController").show(!0,!0)},closeTip:function(){s.triggerHandler("closePowerTip")}}})(jQuery)